<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dicion√°rio de Rimas</title>
    <style>
        :root { --primary: #6366f1; --bg: #f8fafc; --card-bg: #ffffff; --text: #1e293b; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 40px 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        
        .search-box { background: var(--card-bg); padding: 2rem; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); text-align: center; margin-bottom: 2rem; }
        input { padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; width: 100%; max-width: 400px; font-size: 1.1rem; outline: none; }
        input:focus { border-color: var(--primary); }
        button { padding: 12px 25px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; font-weight: bold; margin-left: 5px; }
        
        .result-header { text-align: center; margin-bottom: 30px; display: none; }
        .word-title { font-size: 3rem; color: var(--primary); text-transform: capitalize; margin: 0; }
        .tag { background: #e0e7ff; color: var(--primary); padding: 4px 12px; border-radius: 15px; font-weight: 600; font-size: 0.9rem; margin: 5px; display: inline-block;}

        /* LISTA √öNICA */
        .results-container { display: none; background: var(--card-bg); padding: 30px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        
        .syl-block { margin-bottom: 25px; }
        .syl-title { font-size: 1.1rem; color: #94a3b8; font-weight: 800; text-transform: uppercase; border-bottom: 1px solid #e2e8f0; margin-bottom: 15px; padding-bottom: 5px; }
        
        .w-list { display: flex; flex-wrap: wrap; gap: 8px; }
        .w-pill { background: #f8fafc; border: 1px solid #e2e8f0; padding: 8px 16px; border-radius: 8px; cursor: pointer; transition: 0.2s; font-size: 1.05rem; }
        .w-pill:hover { border-color: var(--primary); transform: translateY(-2px); background: #eef2ff; color: var(--primary); }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; backdrop-filter: blur(2px); }
        .modal-content { background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 500px; position: relative; }
        .close { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; }
        .def-text { line-height: 1.6; margin-top: 15px; color: #334155; }
    </style>
</head>
<body>

<div class="container">
    <div class="search-box">
        <h1>Dicion√°rio de Rimas</h1>
        <div style="margin-top:15px">
            <input type="text" id="inp" placeholder="Digite uma palavra..." onkeypress="if(event.key==='Enter') rimar()">
            <button onclick="rimar()">Rimar</button>
        </div>
        <div id="msg" style="margin-top:15px; color:#ef4444; display:none"></div>
    </div>

    <div id="header" class="result-header">
        <h2 id="term" class="word-title"></h2>
        <div>
            <span id="cls" class="tag"></span>
            <span id="ipa" class="tag" style="background:#f1f5f9; color:#64748b"></span>
            <span id="org" class="tag" style="background:#d1fae5; color:#047857; display:none"></span>
        </div>
    </div>

    <div id="results" class="results-container"></div>
</div>

<div id="modal" class="modal-overlay" onclick="if(event.target===this) this.style.display='none'">
    <div class="modal-content">
        <span class="close" onclick="document.getElementById('modal').style.display='none'">&times;</span>
        <h2 id="mWord" style="margin:0; color:var(--primary); text-transform:capitalize"></h2>
        <span id="mClass" style="color:#64748b; font-size:0.9rem; font-weight:bold"></span>
        <div id="mDef" class="def-text"></div>
    </div>
</div>

<script>
    // üëá SEU LINK DO RENDER AQUI
    const API_URL = "https://dicionario-online.onrender.com";

    async function rimar() {
        const termo = document.getElementById('inp').value.trim();
        if(!termo) return;
        
        document.getElementById('header').style.display = 'none';
        document.getElementById('results').style.display = 'none';
        document.getElementById('msg').innerText = "Pesquisando...";
        document.getElementById('msg').style.display = 'block';

        try {
            const res = await fetch(`${API_URL}/rimar/${termo}`);
            if(!res.ok) throw new Error('Palavra n√£o encontrada.');
            const data = await res.json();

            document.getElementById('term').innerText = data.termo;
            document.getElementById('cls').innerText = data.classe_gramatical;
            document.getElementById('ipa').innerText = `/${data.ipa}/`;
            
            const org = document.getElementById('org');
            if(data.origem) { org.innerText = data.origem; org.style.display='inline-block'; }
            else org.style.display='none';

            render(data.rimas);

            document.getElementById('msg').style.display = 'none';
            document.getElementById('header').style.display = 'block';
            document.getElementById('results').style.display = 'block';

        } catch(e) {
            document.getElementById('msg').innerText = "‚ùå " + e.message;
        }
    }

    function render(lista) {
        const div = document.getElementById('results');
        div.innerHTML = '';

        if(lista.length === 0) {
            div.innerHTML = '<p style="text-align:center; color:#ccc;">Nenhuma rima encontrada.</p>';
            return;
        }

        const grp = {};
        lista.forEach(i => {
            const s = i.silabas || '?';
            if(!grp[s]) grp[s] = [];
            grp[s].push(i);
        });

        Object.keys(grp).sort((a,b)=>a-b).forEach(k => {
            let html = `<div class="syl-block"><div class="syl-title">${k} S√≠laba${k>1?'s':''} <span style="font-weight:400; color:#cbd5e1">(${grp[k].length})</span></div><div class="w-list">`;
            grp[k].forEach(p => {
                let icon = '';
                if(p.origem && p.origem.includes('Afro')) icon = ' ü•Å';
                if(p.origem && p.origem.includes('Ind√≠gena')) icon = ' üèπ';
                html += `<div class="w-pill" onclick="def('${p.palavra}')">${p.palavra}${icon}</div>`;
            });
            div.innerHTML += html + '</div></div>';
        });
    }

    async function def(palavra) {
        const m = document.getElementById('modal');
        document.getElementById('mWord').innerText = palavra;
        document.getElementById('mClass').innerText = "...";
        document.getElementById('mDef').innerText = "Buscando significado...";
        m.style.display = 'flex';

        try {
            const res = await fetch(`${API_URL}/definicao/${palavra}`);
            const d = await res.json();
            document.getElementById('mClass').innerText = d.classe;
            document.getElementById('mDef').innerHTML = d.definicao.split('|').map(x=>`<p>‚Ä¢ ${x.trim()}</p>`).join('');
        } catch(e) {
            document.getElementById('mDef').innerText = "Defini√ß√£o indispon√≠vel.";
        }
    }
</script>
</body>
</html>